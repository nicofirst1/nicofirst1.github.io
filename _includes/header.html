<header class="site_header" id="siteHeader">
    <div class="site_header_bg" aria-hidden="true"></div>
    <div class="site_header_container">
        <a href="{{ '/' | relative_url }}" class="site_brand">
            <img src="{{ '/assets/images/logo2.png' | relative_url }}" alt="Nicolo Brandizzi logo" class="brand_logo">
            <span class="brand_copy">
                <span class="brand_name">Dr. Nicolo' Brandizzi</span>
                <span class="brand_tagline">Curious AI researcher & collaborator</span>
            </span>
        </a>

        <button class="nav_toggle" type="button" aria-label="Toggle navigation" aria-expanded="false" data-target="siteNav">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <nav class="site_nav" id="siteNav" aria-label="Primary">
            <ul class="site_nav_list">
                {% for n in site.data.navigation %}
                    <li>
                        <a href="{{ n.link | relative_url }}" class="site_nav_link{% if n.page_id == page.page_id %} is-active{% endif %}">
                            {{ n.title }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </nav>
    </div>
</header>

<script>
    (function () {
        const header = document.getElementById('siteHeader');
        const toggle = document.querySelector('.nav_toggle');
        const nav = toggle ? document.getElementById(toggle.dataset.target || '') : null;

        if (toggle && nav) {
            const navLinks = nav.querySelectorAll('a');

            const closeMenu = () => {
                nav.classList.remove('is-open');
                toggle.classList.remove('is-active');
                toggle.setAttribute('aria-expanded', 'false');
                document.body.classList.remove('menu-open');
            };

            toggle.addEventListener('click', () => {
                const isOpen = nav.classList.toggle('is-open');
                toggle.classList.toggle('is-active', isOpen);
                toggle.setAttribute('aria-expanded', String(isOpen));
                document.body.classList.toggle('menu-open', isOpen);
            });

            navLinks.forEach((link) => {
                link.addEventListener('click', closeMenu);
            });

            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape') {
                    closeMenu();
                }
            });
        }

        const handleScroll = () => {
            if (!header) return;
            const isScrolled = window.scrollY > 12;
            header.classList.toggle('is-scrolled', isScrolled);
        };

        handleScroll();
        window.addEventListener('scroll', handleScroll, { passive: true });
    })();
</script>
